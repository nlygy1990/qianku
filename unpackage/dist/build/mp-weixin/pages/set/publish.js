(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/set/publish"],{"0b6a":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("2f62");function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){a(e,t,n[t])})}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i={data:function(){return{klist:{password:"修改密码",username:"修改账号",phone:"修改手机",nickname:"修改昵称"},keywords:"",val:"",username:"",mobile:"",phonecode:"",oldpassword:"",newpassword:"",renewpassword:"",showPassword:!0,showPassworda:!0,showPasswordb:!0,logining:!1,keyong:0,scode:!1,getcode:"获取验证码",phonetoken:""}},onLoad:function(t){var n=e.getStorageSync("cbe_token");if(n)e.setNavigationBarTitle({title:this.klist[t.keywords]}),this.keywords=t.keywords,this.val=t.val,this.username=t.val;else{e.showToast({title:"未登录或无权限",icon:"none"});setTimeout(function(){e.navigateBack({delta:1})},1e3)}},methods:s({},(0,o.mapMutations)(["logout"]),{inputChange:function(e){var t=e.currentTarget.dataset.key;this[t]=e.detail.value},inputChangeu:function(t){var n=this,o=t.currentTarget.dataset.key;if(this[o]=t.detail.value,"username"==this.keywords){if(t.detail.value==this.val||t.detail.value.length<4)return!1;e.request({url:e.getStorageSync("hostname")+"?action=index/member/Checkusername",data:{username:t.detail.value},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){var t=e.data;0==t.code?n.keyong=1:n.keyong=2}})}},inputChangep:function(t){var n=this,o=t.currentTarget.dataset.key;if(this[o]=t.detail.value,"phone"==this.keywords){if(t.detail.value==this.val)return!1;var s=/^1[0-9]{10,10}$/;if(!s.test(t.detail.value))return this.keyong=2,!1;e.request({url:e.getStorageSync("hostname")+"?action=index/member/Checkphone",data:{phone:t.detail.value},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){var t=e.data;0==t.code?n.keyong=1:n.keyong=2}})}},changePassword:function(){this.showPassword=!this.showPassword},changePassworda:function(){this.showPassworda=!this.showPassworda},changePasswordb:function(){this.showPasswordb=!this.showPasswordb},toChangeInfo:function(){var t=this;this.logining=!0;var n="";if("username"==this.keywords){if(this.username==this.val)return e.showToast({title:"您的账号没有修改",icon:"none"}),this.logining=!1,!1;n={keys:"username",val:this.username,token:e.getStorageSync("cbe_token")}}else if("nickname"==this.keywords){if(this.username==this.val)return e.showToast({title:"您的昵称没有修改",icon:"none"}),this.logining=!1,!1;n={keys:"nickname",val:this.username,token:e.getStorageSync("cbe_token")}}e.showLoading({title:"正在重置",mask:!0}),e.request({url:e.getStorageSync("hostname")+"?action=index/member/changeInfo",data:n,method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){e.hideLoading();var o=n.data;if(0==o.code){e.showToast({title:o.msg,icon:"success",mask:!0,duration:3e3});setTimeout(function(){e.navigateBack({delta:1})},3e3)}else e.showToast({title:o.msg,icon:"none"}),t.logining=!1}})},toChange:function(){var t=this;return this.logining=!0,""==this.oldpassword?(e.showToast({title:"旧密码不能为空",icon:"none"}),this.logining=!1,!1):""==this.newpassword?(e.showToast({title:"新密码不能为空",icon:"none"}),this.logining=!1,!1):this.CheckPassWord(this.newpassword)?this.renewpassword?this.newpassword!=this.renewpassword?(e.showToast({title:"两次密码不一致",icon:"none"}),this.logining=!1,!1):(e.showLoading({title:"正在重置",mask:!0}),void e.request({url:e.getStorageSync("hostname")+"?action=index/member/changepwd",data:{oldpassword:this.oldpassword,newpassword:this.newpassword,renewpassword:this.renewpassword,token:e.getStorageSync("cbe_token")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){e.hideLoading();var o=n.data;if(0==o.code){e.showToast({title:o.msg,icon:"success",mask:!0,duration:3e3}),e.removeStorageSync("cbe_token"),t.logout();setTimeout(function(){e.redirectTo({url:"/pages/public/login"})},3e3)}else e.showToast({title:o.msg,icon:"none"}),t.logining=!1}})):(e.showToast({title:"请再次输入新密码",icon:"none"}),this.logining=!1,!1):(e.showToast({title:"密码格式不正确",icon:"none"}),this.logining=!1,!1)},toChangePhone:function(){var t=this;if(this.logining=!0,!this.mobile)return e.showToast({title:"新手机号不能为空",icon:"none"}),this.logining=!1,!1;var n=/^1[0-9]{10,10}$/;return n.test(this.mobile)?this.phonecode?(e.showLoading({title:"正在处理",mask:!0}),void e.request({url:e.getStorageSync("hostname")+"?action=index/member/changeMobile",data:{mobile:this.mobile,phonecode:this.phonecode,phonetoken:this.phonetoken,token:e.getStorageSync("cbe_token")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){e.hideLoading();var o=n.data;if(0==o.code){e.showToast({title:o.msg,icon:"success",mask:!0,duration:3e3});setTimeout(function(){e.navigateBack({delta:1})},3e3)}else e.showToast({title:o.msg,icon:"none"}),t.logining=!1}})):(e.showToast({title:"手机验证码不能为空",icon:"none"}),this.logining=!1,!1):(e.showToast({title:"新手机号格式不正确",icon:"none"}),this.logining=!1,!1)},CheckPassWord:function(e){var t=e;if(null==t||t.length<6||t.length>20)return!1;var n=new RegExp(/^[0-9A-Za-z_]+$/);if(!n.test(t))return!1;var o=new RegExp(/[A-Za-z_].*[0-9]|[0-9].*[A-Za-z_]/);return!!o.test(t)},getPhoneCode:function(t){var n=this;if(0==this.scode){var o=/^1[0-9]{10,10}$/;if(o.test(this.mobile)){var s=120;this.scode=!0,this.timer=setInterval(function(){s-=1,"0"==s?(n.getcode="获取验证码",s=120,n.scode=!1,clearInterval(n.timer)):n.getcode="重新获取("+s+"s)"},1e3),e.showLoading({title:"正在获取",mask:!0}),e.request({url:e.getStorageSync("hostname")+"?action=index/common/getphonecode",data:{phone:this.mobile,use:"bind"},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){e.hideLoading();var o=t.data;0==o.code?(e.showToast({title:o.msg,icon:"success",mask:!0,duration:3e3}),n.phonetoken=o.token):(e.showToast({title:o.msg,icon:"none"}),n.getcode="获取验证码",s=120,n.scode=!1,clearInterval(n.timer))},fail:function(t){e.showToast({title:"网络连接超时，请检查您的网络",icon:"none"});setTimeout(function(){n.getcode="获取验证码",s=120,n.scode=!1,clearInterval(n.timer)},1e3)}})}else e.showToast({title:"手机号码格式错误",icon:"none"})}}})};t.default=i}).call(this,n("543d")["default"])},"1ab7":function(e,t,n){"use strict";var o=n("65b1"),s=n.n(o);s.a},"3bfc":function(e,t,n){"use strict";(function(e){n("7086"),n("921b");o(n("66fd"));var t=o(n("590f"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"590f":function(e,t,n){"use strict";n.r(t);var o=n("bc0e"),s=n("da52");for(var a in s)"default"!==a&&function(e){n.d(t,e,function(){return s[e]})}(a);n("1ab7");var i=n("2877"),r=Object(i["a"])(s["default"],o["a"],o["b"],!1,null,null,null);t["default"]=r.exports},"65b1":function(e,t,n){},bc0e:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return s})},da52:function(e,t,n){"use strict";n.r(t);var o=n("0b6a"),s=n.n(o);for(var a in o)"default"!==a&&function(e){n.d(t,e,function(){return o[e]})}(a);t["default"]=s.a}},[["3bfc","common/runtime","common/vendor"]]]);