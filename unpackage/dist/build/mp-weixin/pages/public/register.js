(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/public/register"],{"103c":function(t,e,n){"use strict";n.r(e);var o=n("e5b3"),i=n.n(o);for(var s in o)"default"!==s&&function(t){n.d(e,t,function(){return o[t]})}(s);e["default"]=i.a},"18b2":function(t,e,n){"use strict";n.r(e);var o=n("e20b"),i=n("103c");for(var s in i)"default"!==s&&function(t){n.d(e,t,function(){return i[t]})}(s);n("51dd");var a=n("2877"),r=Object(a["a"])(i["default"],o["a"],o["b"],!1,null,null,null);e["default"]=r.exports},"51dd":function(t,e,n){"use strict";var o=n("6587"),i=n.n(o);i.a},6587:function(t,e,n){},d17f:function(t,e,n){"use strict";(function(t){n("7086"),n("921b");o(n("66fd"));var e=o(n("18b2"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},e20b:function(t,e,n){"use strict";var o=function(){var t=this,e=t.$createElement;t._self._c},i=[];n.d(e,"a",function(){return o}),n.d(e,"b",function(){return i})},e5b3:function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=n("2f62");function i(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){s(t,e,n[e])})}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a={data:function(){return{keyong:0,password:"",repassword:"",showPassword:!0,mobile:"",imgcode:"",imgyzcode:"",phonecode:"",phonetoken:"",showPassworda:!0,scode:!1,getcode:"获取验证码",logining:!1,usertoken:"",bkts:"如果您已获得如新CN卡号，可点击绑定您的账号，成为如新海外购平台的推广商，获得专属产品分享链接及分享红利。",width:70,height:30,uid:0,xieyi:!0}},onLoad:function(e){var n=this;setTimeout(function(){n.init()},100),this.usertoken=t.getStorageSync("cbe_retoken"),e.uid&&(this.uid=e.uid)},onShow:function(){t.getStorageSync("cbe_token")&&t.switchTab({url:"/pages/index/index"})},methods:i({},(0,o.mapMutations)(["register","login"]),{inputChange:function(t){var e=t.currentTarget.dataset.key;this[e]=t.detail.value},toXieyi:function(){t.navigateTo({url:"/pages/public/onepage?id=16"})},checkboxChange:function(t){this.xieyi=!this.xieyi},inputChangm:function(e){var n=this,o=e.detail.value;this.mobile=o;var i=/^1[0-9]{10,10}$/;i.test(o)?t.request({url:t.getStorageSync("hostname")+"?action=index/login/checkphone",data:{phone:o},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){var e=t.data;0==e.code?n.keyong=1:n.keyong=2}}):this.keyong=0},changePassword:function(){this.showPassword=!this.showPassword},changePassworda:function(){this.showPassworda=!this.showPassworda},toLogin:function(){this.usertoken?t.redirectTo({url:"dsflogin"}):t.navigateBack({delta:1})},toRegiser:function(){var e=this;this.logining=!0;var n=/^1[0-9]{10,10}$/;return this.mobile?n.test(this.mobile)?this.imgcode?this.imgcode!=this.imgyzcode?(t.showToast({title:"图形验证码错误",icon:"none"}),this.logining=!1,!1):this.phonecode?this.password?this.CheckPassWord(this.password)?this.repassword?this.password!=this.repassword?(t.showToast({title:"两次密码不一致",icon:"none"}),this.logining=!1,!1):this.xieyi?(t.showLoading({title:"正在提交",mask:!0}),void t.request({url:t.getStorageSync("hostname")+"?action=index/login/register",data:{phone:this.mobile,imgcode:this.imgcode,code:this.phonecode,token:this.phonetoken,password:this.password,repassword:this.repassword,usertoken:this.usertoken,uid:this.uid},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(n){t.hideLoading();var o=n.data;if(0==o.code){t.setStorageSync("cbe_token",o.token),e.phonetoken="",t.showToast({title:o.msg,icon:"success",mask:!0,duration:3e3}),e.login(o.data);var i=e.bkts;setTimeout(function(){t.showModal({title:"推广商申请",cancelText:"跳过",confirmText:"绑定",content:i,success:function(e){e.confirm?t.redirectTo({url:"bindCn"}):e.cancel&&t.switchTab({url:"../user/user"})}})},2e3)}else t.showToast({title:o.msg,icon:"none"}),e.logining=!1}})):(t.showToast({title:"请先同意注册协议",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"请再次确认密码",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"密码格式不正确",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"密码不能为空",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"手机验证码不能为空",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"图形验证码不能为空",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"手机号码格式错误",icon:"none"}),this.logining=!1,!1):(t.showToast({title:"手机号码不能为空",icon:"none"}),this.logining=!1,!1)},getPhoneCode:function(e){var n=this;if(0==this.scode){var o=/^1[0-9]{10,10}$/;if(o.test(this.mobile)){if(!this.imgcode)return t.showToast({title:"图形验证码不能为空",icon:"none"}),!1;if(this.imgcode!=this.imgyzcode)return t.showToast({title:"图形验证码错误",icon:"none"}),this.logining=!1,!1;var i=120;this.scode=!0,this.timer=setInterval(function(){i-=1,"0"==i?(n.getcode="获取验证码",i=120,n.scode=!1,clearInterval(n.timer)):n.getcode="重新获取("+i+"s)"},1e3),t.showLoading({title:"正在获取",mask:!0}),t.request({url:t.getStorageSync("hostname")+"?action=index/common/getphonecode",data:{phone:this.mobile,use:"register"},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){t.hideLoading();var o=e.data;if(0==o.code)t.showToast({title:o.msg,icon:"success",mask:!0,duration:3e3}),console.log(o.msg),n.phonetoken=o.token;else{t.showToast({title:o.msg,icon:"none"});setTimeout(function(){n.getcode="获取验证码",i=120,n.scode=!1,clearInterval(n.timer)},1e3)}},fail:function(e){t.showToast({title:"网络连接超时，请检查您的网络",icon:"none"});setTimeout(function(){n.getcode="获取验证码",i=120,n.scode=!1,clearInterval(n.timer)},1e3)}})}else t.showToast({title:"手机号码格式错误",icon:"none"})}},CheckPassWord:function(t){var e=t;if(null==e||e.length<6||e.length>20)return!1;var n=new RegExp(/^[0-9A-Za-z_]+$/);if(!n.test(e))return!1;var o=new RegExp(/[A-Za-z_].*[0-9]|[0-9].*[A-Za-z_]/);return!!o.test(e)},init:function(){var e=t.createCanvasContext("imgcanvas",this),n=this.width,o=this.height;e.setFillStyle("white"),e.setLineWidth(5),e.fillRect(0,0,n,o);for(var i=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","S","Y","Z","1","2","3","4","5","6","7","8","9","0"],s="",a=0;a<4;a++){var r=i[this.rn(0,i.length)],c=this.rn(-30,30);e.setFontSize(18),e.setTextBaseline("top"),e.setFillStyle(this.rc(80,150)),e.save(),e.translate(15*a+15,parseInt(o/1.5)),e.rotate(c*Math.PI/180),e.fillText(r,-10,-15),e.restore(),s+=r}t.setStorage({key:"imgcode",data:s}),this.imgyzcode=s;for(a=0;a<40;a++)e.beginPath(),e.arc(this.rn(0,n),this.rn(0,o),1,0,2*Math.PI),e.closePath(),e.setFillStyle(this.rc(150,200)),e.fill();e.draw()},rc:function(t,e){var n=this.rn(t,e),o=this.rn(t,e),i=this.rn(t,e);return"rgb("+n+","+o+","+i+")"},rn:function(t,e){return parseInt(Math.random()*(t-e))+e},refresh:function(){this.init()},canvasIdErrorCallback:function(t){console.error(t.detail.errMsg)}})};e.default=a}).call(this,n("543d")["default"])}},[["d17f","common/runtime","common/vendor"]]]);