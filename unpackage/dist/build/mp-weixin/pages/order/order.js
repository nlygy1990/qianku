(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/order/order"],{"158d":function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return a})},"48f8":function(e,t,n){"use strict";n.r(t);var o=n("158d"),a=n("9eef");for(var r in a)"default"!==r&&function(e){n.d(t,e,function(){return a[e]})}(r);n("594c");var i=n("2877"),d=Object(i["a"])(a["default"],o["a"],o["b"],!1,null,null,null);t["default"]=d.exports},"594c":function(e,t,n){"use strict";var o=n("8633"),a=n.n(o);a.a},7830:function(e,t,n){"use strict";(function(e){n("7086"),n("921b");o(n("66fd"));var t=o(n("48f8"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},8633:function(e,t,n){},"9eef":function(e,t,n){"use strict";n.r(t);var o=n("d693"),a=n.n(o);for(var r in o)"default"!==r&&function(e){n.d(t,e,function(){return o[e]})}(r);t["default"]=a.a},d693:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;o(n("2d23"));function o(e){return e&&e.__esModule?e:{default:e}}var a=function(){return n.e("components/uni-load-more/uni-load-more").then(n.bind(null,"e4cb"))},r=function(){return n.e("components/empty").then(n.bind(null,"ca28"))},i={components:{uniLoadMore:a,empty:r},data:function(){return{tabCurrentIndex:0,navList:[{state:0,text:"全部",loadingType:"more",orderList:[],pn:0},{state:1,text:"待付款",loadingType:"more",orderList:[],pn:0},{state:2,text:"待发货",loadingType:"more",orderList:[],pn:0},{state:3,text:"待收货",loadingType:"more",orderList:[],pn:0},{state:4,text:"已完成",loadingType:"more",orderList:[],pn:0}]}},onLoad:function(e){this.tabCurrentIndex=+e.state},onShow:function(){this.loadData("refresh")},methods:{goDetail:function(t){e.navigateTo({url:"/pages/order/detail?id="+t})},navTo:function(t){e.navigateTo({url:t})},goDelivery:function(t){e.navigateTo({url:"/pages/order/delivery?id="+t})},zaicimai:function(t){e.setStorageSync("buyarr",t);var n="/pages/order/createOrder";e.navigateTo({url:n})},loadData:function(t){var n=this,o=this.tabCurrentIndex,a=this.navList[o],r=a.state,i=a.pn;if(("tabChange"!==t||!0!==a.loaded)&&"loading"!=a.loadingType&&"noMore"!=a.loadingType)return 0==i&&e.showLoading({title:"请稍后"}),a.loadingType="loading",e.request({url:e.getStorageSync("hostname")+"?action=index/order/index",data:{order_status:r,token:e.getStorageSync("cbe_token"),pn:i},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){var r=t.data;e.hideLoading(),"0"==r.code?(n.navList[o].pn=Number(i)+Number(1),r.data.forEach(function(e){a.orderList.push(e)}),a.loadingType="loaded"):n.navList[o].loadingType="noMore"}}),!1},changeTab:function(e){this.tabCurrentIndex=e.target.current,this.loadData("tabChange")},tabClick:function(e){this.tabCurrentIndex=e},deleteOrder:function(t,n){var o=this;e.showModal({content:"确定删除该订单吗？",confirmColor:"#008AB0",success:function(a){a.confirm&&(e.showLoading({title:"请稍后"}),o.shanchuOrder(n),setTimeout(function(){o.navList[o.tabCurrentIndex].orderList.splice(t,1),e.hideLoading()},600))}})},cancelOrder:function(t){var n=this;e.showModal({content:"确定取消该订单吗？",confirmColor:"#008AB0",success:function(o){o.confirm&&(e.showLoading({title:"请稍后"}),n.quxiaoOrder(t),setTimeout(function(){var o=n.orderStateExp(9),a=o.stateTip,r=o.stateTipColor;t=Object.assign(t,{state:9,stateTip:a,stateTipColor:r});var i=n.navList[1].orderList,d=i.findIndex(function(e){return e.id===t.id});-1!==d&&i.splice(d,1),e.hideLoading()},600))}})},quxiaoOrder:function(t){0==t.status&&e.request({url:e.getStorageSync("hostname")+"?action=index/order/order_quxiao",data:{id:t.ordersn,token:e.getStorageSync("cbe_token")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){var t=e.data;t.code}})},shouhuo:function(t){var n=this;e.showModal({content:"确定已经收货了吗？",confirmColor:"#008AB0",success:function(o){o.confirm&&(e.showLoading({title:"请稍后"}),e.request({url:e.getStorageSync("hostname")+"?action=index/order/order_shouhuo",data:{id:t.ordersn,token:e.getStorageSync("cbe_token")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(o){e.hideLoading();var a=o.data;0==a.code&&(n.loadData(),setTimeout(function(){var o=n.orderStateExp(4),a=o.stateTip,r=o.stateTipColor;t=Object.assign(t,{state:4,stateTip:a,stateTipColor:r});var i=n.navList[1].orderList,d=i.findIndex(function(e){return e.id===t.id});-1!==d&&i.splice(d,1),e.hideLoading()},600))}}))}})},shanchuOrder:function(t){-1==t.status&&e.request({url:e.getStorageSync("hostname")+"?action=index/order/order_shanchu",data:{id:t.ordersn,token:e.getStorageSync("cbe_token")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){var t=e.data;t.code}})},orderStateExp:function(e){var t="",n="#37b0c9";switch(+e){case 1:t="待付款";break;case 2:t="待发货";break;case 3:t="待收货";break;case 4:t="已完成";break;case 9:t="已取消",n="#909399";break}return{stateTip:t,stateTipColor:n}}}};t.default=i}).call(this,n("543d")["default"])}},[["7830","common/runtime","common/vendor"]]]);