(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-erweima-erweima"],{"00e4":function(e,t,n){"use strict";var a=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,n("28a5"),n("20d6");var r=a(n("f499")),o=a(n("795b")),i=console.log,s={log:i,getPosterUrl:function(e){var t=e.backgroundImage,n=e.type;return new o.default(function(e,a){var r;if(t)r=t;else switch(n){case 1:r="";break;default:r="/static/1.jpg";break}r?e(r):a("背景图片路径不存在")})},shareTypeListSheetArray:{array:[0,1,2,3,4,5]},getStorage:function(e,t,n){uni.getStorage({key:e,success:function(e){e.data&&""!=e.data?t&&t(e.data):n&&n()},fail:function(){n&&n()}})},setStorage:function(e,t){i("设置缓存"),i("key："+e),i("data："+(0,r.default)(t)),uni.setStorage({key:e,data:t})},setStorageSync:function(e,t){uni.setStorageSync(e,t)},getStorageSync:function(e){return uni.getStorageSync(e)},clearStorageSync:function(){uni.clearStorageSync()},removeStorageSync:function(e){uni.removeStorageSync(e)},showLoading:function(e,t){uni.showLoading({title:e,mask:t||!1})},hideLoading:function(){uni.hideLoading()},showToast:function(e,t){uni.showToast({title:e,icon:t||"none"})},getImageInfo:function(e,t,n){e=u(e),uni.getImageInfo({src:e,success:function(e){t&&"function"==typeof t&&t(e)},fail:function(e){n&&"function"==typeof n&&n(e)}})},downloadFile:function(e,t){e=u(e),uni.downloadFile({url:e,success:function(e){t&&"function"==typeof t&&t(e)}})},downloadFile_PromiseFc:function(e){return new o.default(function(t,n){"http"!==e.substring(0,4)?t(e):(e=u(e),i("url:"+e),uni.downloadFile({url:e,success:function(e){e&&e.tempFilePath?t(e.tempFilePath):n("not find tempFilePath")},fail:function(e){n(e)}}))})},saveFile:function(e){uni.saveFile({tempFilePath:e,success:function(e){i("保存成功:"+(0,r.default)(e))}})},downLoadAndSaveFile_PromiseFc:function(e){return new o.default(function(t,n){i("准备下载并保存图片:"+e),"http"===e.substring(0,4)?(e=u(e),uni.downloadFile({url:e,success:function(e){i("下载背景图成功："+(0,r.default)(e)),e&&e.tempFilePath?t(e.tempFilePath):n("not find tempFilePath")},fail:function(e){n(e)}})):t(e)})},checkFile_PromiseFc:function(e){return new o.default(function(t,n){uni.getSavedFileList({success:function(n){var a=n.fileList,r=a.findIndex(function(t){return t.filePath===e});t(r)},fail:function(e){n(e)}})})},removeSavedFile:function(e){uni.getSavedFileList({success:function(t){var n=t.fileList,a=n.findIndex(function(t){return t.filePath===e});a>=0&&uni.removeSavedFile({filePath:e})}})},fileNameInPath:function(e){var t=e.split("/");return t[t.length-1]},getImageInfo_PromiseFc:function(e){return new o.default(function(t,n){i("准备获取图片信息:"+e),e=u(e),uni.getImageInfo({src:e,success:function(e){i("获取图片信息成功:"+(0,r.default)(e)),t(e)},fail:function(e){i("获取图片信息失败:"+(0,r.default)(e)),n(e)}})})},previewImage:function(e){"string"==typeof e&&(e=[e]),uni.previewImage({urls:e})},actionSheet:function(e,t){for(var n=[],a=0;a<e.array.length;a++)switch(e.array[a]){case"sinaweibo":n[a]="新浪微博";break;case"qq":n[a]="QQ";break;case"weixin":n[a]="微信";break;case"WXSceneSession":n[a]="微信好友";break;case"WXSenceTimeline":n[a]="微信朋友圈";break;case"WXSceneFavorite":n[a]="微信收藏";break;case 0:n[a]="图文链接";break;case 1:n[a]="纯文字";break;case 2:n[a]="纯图片";break;case 3:n[a]="音乐";break;case 4:n[a]="视频";break;case 5:n[a]="小程序";break;default:break}this.showActionSheet(n,t)},showActionSheet:function(e,t){uni.showActionSheet({itemList:e,success:function(e){t&&"function"==typeof t&&t(e.tapIndex)}})},getProvider:function(e,t,n){var a=this;uni.getProvider({service:e,success:function(r){if(n){var o={};o.array=r.provider,a.actionSheet(o,function(e){t&&"function"==typeof t&&t(r.provider[e])})}else if("payment"==e){for(var i=r.provider,s=[],u=0;u<i.length;u++)"wxpay"==i[u]?s[u]={name:"微信支付",value:i[u],img:"/static/image/wei.png"}:"alipay"==i[u]&&(s[u]={name:"支付宝支付",value:i[u],img:"/static/image/ali.png"});t&&"function"==typeof t&&t(s)}else t&&"function"==typeof t&&t(r)}})}};function u(e){return e}var l=s;t.default=l},"107f":function(e,t,n){"use strict";n.r(t);var a=n("fd68"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);t["default"]=r.a},3423:function(e,t,n){"use strict";function a(e){var t,n,a;return e<128?[e]:e<2048?(t=192+(e>>6),n=128+(63&e),[t,n]):(t=224+(e>>12),n=128+(e>>6&63),a=128+(63&e),[t,n,a])}function r(e){for(var t=[],n=0;n<e.length;n++)for(var r=e.charCodeAt(n),o=a(r),i=0;i<o.length;i++)t.push(o[i]);return t}function o(e,t){this.typeNumber=-1,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.rsBlocks=null,this.totalDataCount=-1,this.data=e,this.utf8bytes=r(e),this.make()}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o,o.prototype={constructor:o,getModuleCount:function(){return this.moduleCount},make:function(){this.getRightType(),this.dataCache=this.createData(),this.createQrcode()},makeImpl:function(e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++)this.modules[t]=new Array(this.moduleCount);this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(!0,e),this.typeNumber>=7&&this.setupTypeNumber(!0),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++)if(!(e+n<=-1||this.moduleCount<=e+n))for(var a=-1;a<=7;a++)t+a<=-1||this.moduleCount<=t+a||(this.modules[e+n][t+a]=0<=n&&n<=6&&(0==a||6==a)||0<=a&&a<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=a&&a<=4)},createQrcode:function(){for(var e=0,t=0,n=null,a=0;a<8;a++){this.makeImpl(a);var r=u.getLostPoint(this);(0==a||e>r)&&(e=r,t=a,n=this.modules)}this.modules=n,this.setupTypeInfo(!1,t),this.typeNumber>=7&&this.setupTypeNumber(!1)},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0,null==this.modules[6][e]&&(this.modules[6][e]=e%2==0))},setupPositionAdjustPattern:function(){for(var e=u.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var a=e[t],r=e[n];if(null==this.modules[a][r])for(var o=-2;o<=2;o++)for(var i=-2;i<=2;i++)this.modules[a+o][r+i]=-2==o||2==o||-2==i||2==i||0==o&&0==i}},setupTypeNumber:function(e){for(var t=u.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var a=!e&&1==(t>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=a,this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=a}},setupTypeInfo:function(e,t){for(var n=i[this.errorCorrectLevel]<<3|t,a=u.getBCHTypeInfo(n),r=0;r<15;r++){var o=!e&&1==(a>>r&1);r<6?this.modules[r][8]=o:r<8?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o;o=!e&&1==(a>>r&1);r<8?this.modules[8][this.moduleCount-r-1]=o:r<9?this.modules[8][15-r-1+1]=o:this.modules[8][15-r-1]=o}this.modules[this.moduleCount-8][8]=!e},createData:function(){var e=new d,t=this.typeNumber>9?16:8;e.put(4,4),e.put(this.utf8bytes.length,t);for(var n=0,a=this.utf8bytes.length;n<a;n++)e.put(this.utf8bytes[n],8);e.length+4<=8*this.totalDataCount&&e.put(0,4);while(e.length%8!=0)e.putBit(!1);while(1){if(e.length>=8*this.totalDataCount)break;if(e.put(o.PAD0,8),e.length>=8*this.totalDataCount)break;e.put(o.PAD1,8)}return this.createBytes(e)},createBytes:function(e){for(var t=0,n=0,a=0,r=this.rsBlock.length/3,o=new Array,i=0;i<r;i++)for(var s=this.rsBlock[3*i+0],l=this.rsBlock[3*i+1],c=this.rsBlock[3*i+2],h=0;h<s;h++)o.push([c,l]);for(var d=new Array(o.length),g=new Array(o.length),p=0;p<o.length;p++){var v=o[p][0],m=o[p][1]-v;n=Math.max(n,v),a=Math.max(a,m),d[p]=new Array(v);for(i=0;i<d[p].length;i++)d[p][i]=255&e.buffer[i+t];t+=v;var w=u.getErrorCorrectPolynomial(m),y=new f(d[p],w.getLength()-1),b=y.mod(w);g[p]=new Array(w.getLength()-1);for(i=0;i<g[p].length;i++){var x=i+b.getLength()-g[p].length;g[p][i]=x>=0?b.get(x):0}}var P=new Array(this.totalDataCount),k=0;for(i=0;i<n;i++)for(p=0;p<o.length;p++)i<d[p].length&&(P[k++]=d[p][i]);for(i=0;i<a;i++)for(p=0;p<o.length;p++)i<g[p].length&&(P[k++]=g[p][i]);return P},mapData:function(e,t){for(var n=-1,a=this.moduleCount-1,r=7,o=0,i=this.moduleCount-1;i>0;i-=2){6==i&&i--;while(1){for(var s=0;s<2;s++)if(null==this.modules[a][i-s]){var l=!1;o<e.length&&(l=1==(e[o]>>>r&1));var c=u.getMask(t,a,i-s);c&&(l=!l),this.modules[a][i-s]=l,r--,-1==r&&(o++,r=7)}if(a+=n,a<0||this.moduleCount<=a){a-=n,n=-n;break}}}}},o.PAD0=236,o.PAD1=17;for(var i=[1,0,3,2],s={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},u={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){var t=e<<10;while(u.getBCHDigit(t)-u.getBCHDigit(u.G15)>=0)t^=u.G15<<u.getBCHDigit(t)-u.getBCHDigit(u.G15);return(e<<10|t)^u.G15_MASK},getBCHTypeNumber:function(e){var t=e<<12;while(u.getBCHDigit(t)-u.getBCHDigit(u.G18)>=0)t^=u.G18<<u.getBCHDigit(t)-u.getBCHDigit(u.G18);return e<<12|t},getBCHDigit:function(e){var t=0;while(0!=e)t++,e>>>=1;return t},getPatternPosition:function(e){return u.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case s.PATTERN000:return(t+n)%2==0;case s.PATTERN001:return t%2==0;case s.PATTERN010:return n%3==0;case s.PATTERN011:return(t+n)%3==0;case s.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case s.PATTERN101:return t*n%2+t*n%3==0;case s.PATTERN110:return(t*n%2+t*n%3)%2==0;case s.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new f([1],0),n=0;n<e;n++)t=t.multiply(new f([1,l.gexp(n)],0));return t},getLostPoint:function(e){for(var t=e.getModuleCount(),n=0,a=0,r=0;r<t;r++)for(var o=0,i=e.modules[r][0],s=0;s<t;s++){var u=e.modules[r][s];if(s<t-6&&u&&!e.modules[r][s+1]&&e.modules[r][s+2]&&e.modules[r][s+3]&&e.modules[r][s+4]&&!e.modules[r][s+5]&&e.modules[r][s+6]&&(s<t-10?e.modules[r][s+7]&&e.modules[r][s+8]&&e.modules[r][s+9]&&e.modules[r][s+10]&&(n+=40):s>3&&e.modules[r][s-1]&&e.modules[r][s-2]&&e.modules[r][s-3]&&e.modules[r][s-4]&&(n+=40)),r<t-1&&s<t-1){var l=0;u&&l++,e.modules[r+1][s]&&l++,e.modules[r][s+1]&&l++,e.modules[r+1][s+1]&&l++,0!=l&&4!=l||(n+=3)}i^u?o++:(i=u,o>=5&&(n+=3+o-5),o=1),u&&a++}for(s=0;s<t;s++)for(o=0,i=e.modules[0][s],r=0;r<t;r++){u=e.modules[r][s];r<t-6&&u&&!e.modules[r+1][s]&&e.modules[r+2][s]&&e.modules[r+3][s]&&e.modules[r+4][s]&&!e.modules[r+5][s]&&e.modules[r+6][s]&&(r<t-10?e.modules[r+7][s]&&e.modules[r+8][s]&&e.modules[r+9][s]&&e.modules[r+10][s]&&(n+=40):r>3&&e.modules[r-1][s]&&e.modules[r-2][s]&&e.modules[r-3][s]&&e.modules[r-4][s]&&(n+=40)),i^u?o++:(i=u,o>=5&&(n+=3+o-5),o=1)}var c=Math.abs(100*a/t/t-50)/5;return n+=10*c,n}},l={glog:function(e){if(e<1)throw new Error("glog("+e+")");return l.LOG_TABLE[e]},gexp:function(e){while(e<0)e+=255;while(e>=256)e-=255;return l.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},c=0;c<8;c++)l.EXP_TABLE[c]=1<<c;for(c=8;c<256;c++)l.EXP_TABLE[c]=l.EXP_TABLE[c-4]^l.EXP_TABLE[c-5]^l.EXP_TABLE[c-6]^l.EXP_TABLE[c-8];for(c=0;c<255;c++)l.LOG_TABLE[l.EXP_TABLE[c]]=c;function f(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);var n=0;while(n<e.length&&0==e[n])n++;this.num=new Array(e.length-n+t);for(var a=0;a<e.length-n;a++)this.num[a]=e[a+n]}f.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),n=0;n<this.getLength();n++)for(var a=0;a<e.getLength();a++)t[n+a]^=l.gexp(l.glog(this.get(n))+l.glog(e.get(a)));return new f(t,0)},mod:function(e){var t=this.getLength(),n=e.getLength();if(t-n<0)return this;for(var a=new Array(t),r=0;r<t;r++)a[r]=this.get(r);while(a.length>=n){var o=l.glog(a[0])-l.glog(e.get(0));for(r=0;r<e.getLength();r++)a[r]^=l.gexp(l.glog(e.get(r))+o);while(0==a[0])a.shift()}return new f(a,0)}};var h=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];function d(){this.buffer=new Array,this.length=0}o.prototype.getRightType=function(){for(var e=1;e<41;e++){var t=h[4*(e-1)+this.errorCorrectLevel];if(void 0==t)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+this.errorCorrectLevel);for(var n=t.length/3,a=0,r=0;r<n;r++){var o=t[3*r+0],i=t[3*r+2];a+=i*o}var s=e>9?2:1;if(this.utf8bytes.length+s<a||40==e){this.typeNumber=e,this.rsBlock=t,this.totalDataCount=a;break}}},d.prototype={get:function(e){var t=Math.floor(e/8);return this.buffer[t]>>>7-e%8&1},put:function(e,t){for(var n=0;n<t;n++)this.putBit(e>>>t-n-1&1)},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}}},"3b8d":function(e,t,n){"use strict";n.r(t),n.d(t,"default",function(){return i});var a=n("795b"),r=n.n(a);function o(e,t,n,a,o,i,s){try{var u=e[i](s),l=u.value}catch(c){return void n(c)}u.done?t(l):r.a.resolve(l).then(a,o)}function i(e){return function(){var t=this,n=arguments;return new r.a(function(a,r){var i=e.apply(t,n);function s(e){o(i,a,r,s,u,"next",e)}function u(e){o(i,a,r,s,u,"throw",e)}s(void 0)})}}},"4a9c":function(e,t,n){"use strict";var a=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("bd86")),o=a(n("795b"));n("28a5"),n("6c7b");var i={data:function(){return{}},props:{canvasFlag:{type:Boolean,default:!0},posterObj:{type:Object,default:{url:"https://img0.zuipin.cn/mp_zuipin/poster/hch-pro.jpg",icon:"https://img0.zuipin.cn/mp_zuipin/poster/hch-hyj.png",title:"诗酒茶系列 武夷大红袍 2018年 花香型中火 一级 体验装 16g",discountPrice:"250.00",orignPrice:"300.00",code:"https://img0.zuipin.cn/mp_zuipin/poster/hch-code.png"}}},methods:{roundRect:function(e,t,n,a,r,o,i,s,u){if(e.beginPath(),e.arc(t+o,n+o,o,Math.PI,1.5*Math.PI),e.moveTo(t+o,n),e.lineTo(t+a-o,n),e.arc(t+a-o,n+o,o,1.5*Math.PI,2*Math.PI),e.lineTo(t+a,n+r-o),e.arc(t+a-o,n+r-o,o,0,.5*Math.PI),e.arc(t+o,n+r-o,o,.5*Math.PI,Math.PI),e.lineTo(t,n+o),"btn"==u){var l=e.createLinearGradient(0,0,200,0);l.addColorStop(0,i),l.addColorStop(1,s),e.setFillStyle(l),e.fill()}else i&&(e.setFillStyle(i),e.fill()),s&&(e.setStrokeStyle(s),e.stroke());e.closePath(),e.clip()},canvasMultiLineText:function(e,t,n,a){for(var r=t.split(""),o="",i=[],s=0;s<r.length;s++)e.measureText(o).width<n?o+=r[s]:(s--,i.push(o),o="");if(i.push(o),i.length>a){for(var u=i.slice(0,a),l=u[1],c="",f=[],h=0;h<l.length;h++){if(!(e.measureText(c).width<n))break;c+=l[h]}f.push(c);var d=f[0]+"...";u.splice(a-1,1,d),i=u}return i},codeImg:function(){var e=this;return new o.default(function(t,n){request({method:"get",url:"/spSupport/getwxacodeunlimit",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{version:e.$parent.globalData.version,scene:"sku=".concat(e.sku),page:"pages/product/detail",width:"128px"}}).then(function(e){if(0==e.data.code){var n=wx.getFileSystemManager(),a="tmp_img_src",o="".concat(wx.env.USER_DATA_PATH,"/").concat(a,".jpg");n.writeFile({filePath:o,data:e.data.data,encoding:"binary",success:function(){t(o)},fail:function(){this.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}})}else uni.showToast((0,r.default)({title:e.data.message,icon:"none",duration:2e3},"icon","none"))}).catch(function(){e.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})})})},createCanvasImage:function(){var e=this;console.log(this.posterObj,"posterObj"),console.log("海报生成中"),wx.showLoading({title:"海报生成中..."});var t=this,n=wx.getSystemInfoSync();this.phoneH=n.windowHeight,this.phoneW=n.windowWidth;this.phoneW;var a=this.phoneH/667;console.log(this.phoneH,this.phoneW);var r=wx.createCanvasContext("myCanvas"),o=this.posterObj.url,i=this.posterObj.icon,s=this.posterObj.code,u="https://imgzuipin.oss-cn-hangzhou.aliyuncs.com/mp_zuipin/poster/close_btn.png";console.log(r),console.log(this),r.draw(),r.save(),this.roundRect(r,50,40,this.phoneW-100,this.phoneH-120,10,"#fff","#fff"),r.restore(),r.save(),this.roundRect(r,50,40,this.phoneW-100,370*a,10,"#f7f7f7","#f7f7f7"),r.restore(),wx.getImageInfo({src:o,success:function(e){r.save(),t.roundRect(r,(t.phoneW-(t.phoneW-130))/2,55,t.phoneW-130,250*a,10,"#f7f7f7","#f7f7f7"),r.drawImage(e.path,(t.phoneW-(t.phoneW-130))/2,55,t.phoneW-130,250*a,10),r.restore(),r.draw(!0)},fail:function(){t.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),wx.getImageInfo({src:u,success:function(e){r.drawImage(e.path,t.phoneW-100+50+5,40,24,24),r.draw(!0)},fail:function(){t.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),setTimeout(function(){r.setGlobalAlpha(1),r.setFillStyle("#1c1c1c"),r.setFontSize(14),r.font="normal bold 14px sans-serif";for(var t=e.posterObj.title,n=e.canvasMultiLineText(r,t,e.phoneW-130,2),o=360,i=65,s=18,u=0;u<n.length;u++)r.fillText(n[u],i,(o+s*u-15)*a,e.phoneW-130),r.draw(!0)},500),wx.getImageInfo({src:i,success:function(e){r.drawImage(e.path,65,380*a,44,15),r.draw(!0)},fail:function(){t.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),r.setFontSize(12),r.setFillStyle("#c00000"),r.font="normal 12px sans-serif",r.fillText("￥",110,396*a,60),r.setFontSize(16);var l=this.posterObj.discountPrice,c=this.posterObj.orignPrice,f=r.measureText(l).width;r.fillText(l,120,396*a,f),r.beginPath(),r.setFontSize(10),r.setFillStyle("#999");var h=r.measureText(c).width;r.fillText("￥".concat(c),120+f+5,395*a,h),r.moveTo(120+f+5,392*a),r.lineTo(120+f+5+h,392*a),r.setStrokeStyle("#999"),r.stroke(),r.closePath(),wx.getImageInfo({src:s,success:function(e){r.drawImage(e.path,(t.phoneW-70)/2,430*a,70,70),r.draw(!0)},fail:function(){t.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),r.setFontSize(14),r.setFillStyle("#2f1709"),r.font="normal bold 14px sans-serif",r.fillText("小程序的名称",(t.phoneW-90)/2,530*a,90),r.setFontSize(14),r.setFillStyle("#ff5f33"),r.font="normal 14px sans-serif",r.fillText("长按/扫描识别查看商品",(t.phoneW-140)/2,550*a,140),r.save(),this.roundRect(r,(this.phoneW-160)/2,this.phoneH-55,160,36,18,"#ff3600","#ff6a00","btn"),r.restore(),r.setFontSize(14),r.setFillStyle("#fff"),r.font="normal bold 14px sans-serif",r.fillText("保存图片",(t.phoneW-58)/2,this.phoneH-33,58),wx.hideLoading()},saveCanvasImage:function(){console.log("点击了保存"),wx.showLoading({title:"保存中..."});var e=this;uni.canvasToTempFilePath({x:50,y:40,width:this.phoneW-100,height:this.phoneH-120,destWidth:5*(this.phoneW-100),destHeight:5*(this.phoneH-120),canvasId:"myCanvas",success:function(t){uni.saveImageToPhotosAlbum({filePath:t.tempFilePath,success:function(t){wx.hideLoading(),uni.showToast({title:"图片保存成功，可以去分享啦~",duration:2e3}),e.canvasCancelEvn()},fail:function(){uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),wx.hideLoading()}})},fail:function(){uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),wx.hideLoading()}})},canvasCancelEvn:function(){console.log(),this.$emit("cancel",!0)}}};t.default=i},"64b2":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"canvas_box",attrs:{hidden:e.canvasFlag}},[n("v-uni-view",{staticClass:"canvas_box_mask"}),n("v-uni-icon",{staticClass:"canvas_close_btn",attrs:{type:"cancel",size:"60",color:"transparent"},on:{click:function(t){t=e.$handleEvent(t),e.canvasCancelEvn(t)}}}),n("v-uni-view",{staticClass:"button-wrapper"},[n("v-uni-cover-view",{staticClass:"save_btn",on:{click:function(t){t=e.$handleEvent(t),e.saveCanvasImage(t)}}})],1)],1)},r=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r})},"6c7b":function(e,t,n){var a=n("5ca1");a(a.P,"Array",{fill:n("36bd")}),n("9c6c")("fill")},"830f":function(e,t,n){"use strict";var a=n("b585"),r=n.n(a);r.a},"913a":function(e,t,n){"use strict";n.r(t);var a=n("c4a3"),r=n("107f");for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);n("dbc6");var i=n("2877"),s=Object(i["a"])(r["default"],a["a"],a["b"],!1,null,"5de76439",null);t["default"]=s.exports},"96cf":function(e,t){!function(t){"use strict";var n,a=Object.prototype,r=a.hasOwnProperty,o="function"===typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag",l="object"===typeof e,c=t.regeneratorRuntime;if(c)l&&(e.exports=c);else{c=t.regeneratorRuntime=l?e.exports:{},c.wrap=b;var f="suspendedStart",h="suspendedYield",d="executing",g="completed",p={},v={};v[i]=function(){return this};var m=Object.getPrototypeOf,w=m&&m(m(E([])));w&&w!==a&&r.call(w,i)&&(v=w);var y=T.prototype=P.prototype=Object.create(v);k.prototype=y.constructor=T,T.constructor=k,T[u]=k.displayName="GeneratorFunction",c.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===k||"GeneratorFunction"===(t.displayName||t.name))},c.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,T):(e.__proto__=T,u in e||(e[u]="GeneratorFunction")),e.prototype=Object.create(y),e},c.awrap=function(e){return{__await:e}},L(S.prototype),S.prototype[s]=function(){return this},c.AsyncIterator=S,c.async=function(e,t,n,a){var r=new S(b(e,t,n,a));return c.isGeneratorFunction(t)?r:r.next().then(function(e){return e.done?e.value:r.next()})},L(y),y[u]="Generator",y[i]=function(){return this},y.toString=function(){return"[object Generator]"},c.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){while(t.length){var a=t.pop();if(a in e)return n.value=a,n.done=!1,n}return n.done=!0,n}},c.values=E,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(F),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0],t=e.completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function a(a,r){return s.type="throw",s.arg=e,t.next=a,r&&(t.method="next",t.arg=n),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),l=r.call(i,"finallyLoc");if(u&&l){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,p):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),F(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;F(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:E(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=n),p}}}function b(e,t,n,a){var r=t&&t.prototype instanceof P?t:P,o=Object.create(r.prototype),i=new A(a||[]);return o._invoke=C(e,n,i),o}function x(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(a){return{type:"throw",arg:a}}}function P(){}function k(){}function T(){}function L(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function S(e){function t(n,a,o,i){var s=x(e[n],e,a);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"===typeof l&&r.call(l,"__await")?Promise.resolve(l.__await).then(function(e){t("next",e,o,i)},function(e){t("throw",e,o,i)}):Promise.resolve(l).then(function(e){u.value=e,o(u)},function(e){return t("throw",e,o,i)})}i(s.arg)}var n;function a(e,a){function r(){return new Promise(function(n,r){t(e,a,n,r)})}return n=n?n.then(r,r):r()}this._invoke=a}function C(e,t,n){var a=f;return function(r,o){if(a===d)throw new Error("Generator is already running");if(a===g){if("throw"===r)throw o;return z()}n.method=r,n.arg=o;while(1){var i=n.delegate;if(i){var s=I(i,n);if(s){if(s===p)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===f)throw a=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=d;var u=x(e,t,n);if("normal"===u.type){if(a=n.done?g:h,u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(a=g,n.method="throw",n.arg=u.arg)}}}function I(e,t){var a=e.iterator[t.method];if(a===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,I(e,t),"throw"===t.method))return p;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var r=x(a,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,p;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function F(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function E(e){if(e){var t=e[i];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var a=-1,o=function t(){while(++a<e.length)if(r.call(e,a))return t.value=e[a],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:z}}function z(){return{value:n,done:!0}}}(function(){return this||"object"===typeof self&&self}()||Function("return this")())},a7ca:function(e,t,n){"use strict";var a=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=f,t.setTextArray=g,t.setImagesArray=v,t.drawText=m,t.drawImage=b,t.drawQrCode=k,n("7f7f"),n("6c7b"),n("28a5");var r=a(n("cebc"));n("c5f6");var o=a(n("f499"));n("96cf");var i=a(n("3b8d")),s=a(n("795b")),u=a(n("00e4")),l=a(n("3423")),c="ShrePosterBackground_";function f(e){return new s.default(function(){var t=(0,i.default)(regeneratorRuntime.mark(function t(n,a){var r,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,h(e);case 3:r=t.sent,n(r),t.next=21;break;case 7:return t.prev=7,t.t0=t["catch"](0),L(e.type),t.prev=10,u.default.log("------------清除缓存后, 开始第二次尝试------------"),t.next=14,h(e);case 14:o=t.sent,n(o),t.next=21;break;case 18:t.prev=18,t.t1=t["catch"](10),a(t.t1);case 21:case"end":return t.stop()}},t,this,[[0,7],[10,18]])}));return function(e,n){return t.apply(this,arguments)}}())}function h(e){var t=e.type,n=e.background,a=e.posterCanvasId,r=e.backgroundImage,l=e.reserve,c=e.textArray,f=e.qrCodeArray,h=e.imagesArray,p=e.setCanvasWH,m=e.setCanvasToTempFilePath,w=e.setDraw,y=e.bgScale,b=e.Context;return new s.default(function(){var e=(0,i.default)(regeneratorRuntime.mark(function e(i,s){var x,P,k,L;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,u.default.showLoading("正在准备海报数据"),b||(b=uni.createCanvasContext(a)),!(n&&n.width&&n.height)){e.next=7;break}x=n,e.next=10;break;case 7:return e.next=9,T({backgroundImage:r,type:t});case 9:x=e.sent;case 10:if(y=y||.75,x.width=x.width*y,x.height=x.height*y,u.default.log("获取背景图信息对象成功:"+(0,o.default)(x)),P={bgObj:x,type:t,bgScale:y},p&&"function"==typeof p&&p(P),!h){e.next=23;break}return"function"==typeof h&&(h=h(P)),u.default.showLoading("正在生成需绘制图片的临时路径"),e.next=21,v(h);case 21:h=e.sent,u.default.hideLoading();case 23:if(c&&("function"==typeof c&&(c=c(P)),c=g(b,c)),!f){e.next=37;break}"function"==typeof f&&(f=f(P)),u.default.showLoading("正在生成需绘制图片的临时路径"),k=0;case 28:if(!(k<f.length)){e.next=36;break}if(!f[k].image){e.next=33;break}return e.next=32,u.default.downloadFile_PromiseFc(f[k].image);case 32:f[k].image=e.sent;case 33:k++,e.next=28;break;case 36:u.default.hideLoading();case 37:return e.next=39,d({Context:b,type:t,posterCanvasId:a,reserve:l,textArray:c,imagesArray:h,bgObj:x,qrCodeArray:f,setCanvasToTempFilePath:m,setDraw:w,bgScale:y});case 39:L=e.sent,u.default.hideLoading(),i({bgObj:x,poster:L,type:t}),e.next=47;break;case 44:e.prev=44,e.t0=e["catch"](0),s(e.t0);case 47:case"end":return e.stop()}},e,this,[[0,44]])}));return function(t,n){return e.apply(this,arguments)}}())}function d(e){var t=e.Context,n=e.type,a=e.posterCanvasId,r=e.reserve,o=e.bgObj,i=e.textArray,l=e.qrCodeArray,c=e.imagesArray,f=e.setCanvasToTempFilePath,h=e.setDraw,d=e.bgScale;return new s.default(function(e,s){try{if(u.default.showLoading("正在绘制海报"),o&&o.path?t.drawImage(o.path,0,0,o.width,o.height):o.backgroundColor&&(t.setFillStyle(o.backgroundColor),t.fillRect(0,0,o.width,o.height)),u.default.showLoading("准备绘制图片"),b(t,c),u.default.showLoading("准备绘制自定义内容"),h&&"function"==typeof h&&h({Context:t,bgObj:o,type:n,bgScale:d}),u.default.showLoading("准备绘制文本"),m(t,i,o),u.default.showLoading("准备绘制二维码"),l&&l.length>0)for(var g=0;g<l.length;g++)k(t,l[g]);u.default.showLoading("绘制中"),t.draw("boolean"==typeof r&&r,function(){u.default.showLoading("准备输出图片");var t={};f&&"function"==typeof f&&(t=f(o,n)),e({tempFilePath:document.querySelector("uni-canvas[canvas-id=".concat(a,"]>canvas")).toDataURL("image/jpeg",t.quality||.8)})})}catch(p){u.default.hideLoading(),s(p)}})}function g(e,t){for(var n=0;n<t.length;n++){var a=t[n];if(u.default.log("字符串信息-初始化之前:"+(0,o.default)(t[n])),a.text&&"string"==typeof a.text&&a.text.length>0){a.alpha=void 0!==a.alpha?a.alpha:1,a.color=a.color||"black",a.size=void 0!==a.size?a.size:10,a.textAlign=a.textAlign||"left",a.textBaseline=a.textBaseline||"middle",a.dx=a.dx||0,a.dy=a.dy||0,a.size=Math.ceil(Number(a.size)),u.default.log("字符串信息-初始化默认值后:"+(0,o.default)(t[n]));var i=p(e,{text:a.text,size:a.size});u.default.log("字符串信息-初始化时的文本长度:"+i);var s={};a.infoCallBack&&"function"===typeof a.infoCallBack&&(s=a.infoCallBack(i)),t[n]=(0,r.default)({},a,{textLength:i},s),u.default.log("字符串信息-infoCallBack后:"+(0,o.default)(t[n]))}}return t}function p(e,t){u.default.log("进入计算文字长度, obj:"+(0,o.default)(t));var n=t.text,a=t.size;e.setFontSize(a);var r=e.measureText(n);if(u.default.log("measureText计算文字长度, textLength:"+(0,o.default)(r)),r=r&&r.width?r.width:0,!r){for(var i=0,s=0;s<n.length;s++){var l=n.substr(s,1);if(/[\u4e00-\u9fa5]/.test(l))i+=1;else if(/[A-Za-z0-9]/.test(l))i+=.75;else{var c=n.charAt(s);/^[\u0000-\u00ff]$/.test(c)?i+=.2:i+=1}}r=i*a}return r}function v(e){return new s.default(function(){var t=(0,i.default)(regeneratorRuntime.mark(function t(n,a){var o,i,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:t.prev=0,o=0;case 2:if(!(o<e.length)){t.next=21;break}if(!e[o].url){t.next=18;break}return i=e[o].url,t.next=7,u.default.downloadFile_PromiseFc(i);case 7:return i=t.sent,e[o].url=i,t.next=11,u.default.getImageInfo_PromiseFc(i);case 11:s=t.sent,e[o].infoCallBack&&"function"===typeof e[o].infoCallBack&&(e[o]=(0,r.default)({},e[o],e[o].infoCallBack(s))),e[o].dx=e[o].dx||0,e[o].dy=e[o].dy||0,e[o].dWidth=e[o].dWidth||s.width,e[o].dHeight=e[o].dHeight||s.height,e[o]=(0,r.default)({},e[o],{imageInfo:s});case 18:o++,t.next=2;break;case 21:n(e),t.next=27;break;case 24:t.prev=24,t.t0=t["catch"](0),a(t.t0);case 27:case"end":return t.stop()}},t,this,[[0,24]])}));return function(e,n){return t.apply(this,arguments)}}())}function m(e,t,n){var a=[];if(t&&t.length>0)for(var i=0;i<t.length;i++){var s=t[i];if(s.text&&s.lineFeed){var l=-1,c=n.width,f=s.size,h=s.dx;if(s.lineFeed instanceof Object){var d=s.lineFeed;l=void 0!==d.lineNum&&"number"===typeof d.lineNum&&d.lineNum>=0?d.lineNum:l,c=void 0!==d.maxWidth&&"number"===typeof d.maxWidth?d.maxWidth:c,f=void 0!==d.lineHeight&&"number"===typeof d.lineHeight?d.lineHeight:f,h=void 0!==d.dx&&"number"===typeof d.dx?d.dx:h}for(var g=s.text.split(""),v="",m=[],w=0,b=g.length;w<b;w++)p(e,{text:v,size:s.size})<=c&&p(e,{text:v+g[w],size:s.size})<=c?(v+=g[w],w==g.length-1&&m.push(v)):(m.push(v),v=g[w]);u.default.log("循环出的文字数组:"+(0,o.default)(m));for(var x=l>=0&&l<m.length?l:m.length,P=0;P<x;P++){var k=m[P];P==x-1&&x<m.length&&(k=k.substring(0,k.length-1)+"...");var T=(0,r.default)({},s,{text:k,dx:0===P?s.dx:h>=0?h:s.dx,dy:s.dy+P*f,textLength:p(e,{text:k,size:s.size})});u.default.log("重新组成的文字对象:"+(0,o.default)(T)),a.push(T)}}else a.push(s)}y(e,a)}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.font&&"string"===typeof e.font)return u.default.log(e.font),e.font;var t="normal",n="normal",a="normal",r=e.size||10,o="sans-serif";return r=Math.ceil(Number(r)),e.fontStyle&&"string"===typeof e.fontStyle&&(t=e.fontStyle.trim()),e.fontVariant&&"string"===typeof e.fontVariant&&(n=e.fontVariant.trim()),!e.fontWeight||"string"!==typeof e.fontWeight&&"number"!==typeof e.fontWeight||(a=e.fontWeight.trim()),e.fontFamily&&"string"===typeof e.fontFamily&&(o=e.fontFamily.trim()),t+" "+n+" "+a+" "+r+"px "+o}function y(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];if(a instanceof Object&&a.text){if(e.font=w(a),e.setFillStyle(a.color),e.setGlobalAlpha(a.alpha),e.setTextAlign(a.textAlign),e.setTextBaseline(a.textBaseline),e.fillText(a.text,a.dx,a.dy),a.lineThrough&&a.lineThrough instanceof Object){u.default.log("有删除线");var r=a.lineThrough;r.alpha=void 0!==r.alpha?r.alpha:a.alpha,r.style=r.style||a.color,r.width=void 0!==r.width?r.width:a.size/10,r.cap=void 0!==r.cap?r.cap:"butt",u.default.log("删除线对象:"+(0,o.default)(r)),e.setGlobalAlpha(r.alpha),e.setStrokeStyle(r.style),e.setLineWidth(r.width),e.setLineCap(r.cap);var i=void 0,s=void 0;switch(a.textAlign){case"left":i=a.dx;break;case"center":i=a.dx-a.textLength/2;break;default:i=a.dx-a.textLength;break}switch(a.textBaseline){case"top":s=a.dy+.5*a.size;break;case"middle":s=a.dy;break;default:s=a.dy-.5*a.size;break}e.beginPath(),e.moveTo(i,s),e.lineTo(i+a.textLength,s),e.stroke(),e.closePath(),u.default.log("删除线完毕")}e.setGlobalAlpha(1),e.font="10px sans-serif"}}}function b(e,t){if(t&&t.length>0)for(var n=0;n<t.length;n++){var a=t[n];u.default.log("imageArrayItem: "+(0,o.default)(a)),a.url&&(a.circleSet?x(e,a):a.roundRectSet&&P(e,a),a.dWidth&&a.dHeight&&a.sx&&a.sy&&a.sWidth&&a.sHeight?e.drawImage(a.url,a.dx||0,a.dy||0,a.dWidth||!1,a.dHeight||!1,a.sx||!1,a.sy||!1,a.sWidth||!1,a.sHeight||!1):a.dWidth&&a.dHeight?e.drawImage(a.url,a.dx||0,a.dy||0,a.dWidth||!1,a.dHeight||!1):e.drawImage(a.url,a.dx||0,a.dy||0),(a.circleSet||a.roundRectSet)&&e.restore())}}function x(e,t){e.save();var n,a,r,o,i=t.dx,s=t.dy,u=t.dWidth,l=t.dHeight,c=t.circleSet;t.imageInfo;("object"===typeof c&&(n=c.x,a=c.y,r=c.r),r)||(o=u>l?l:u,r=o/2);n=n?i+n:(i||0)+r,a=a?s+a:(s||0)+r,e.beginPath(),e.arc(n,a,r,0,2*Math.PI,!1),e.clip(),e.closePath()}function P(e,t){e.save();var n,a=t.dx,r=t.dy,o=t.dWidth,i=t.dHeight,s=t.roundRectSet;t.imageInfo;"object"===typeof s&&(n=s.r),n=n||.1*o,o<2*n&&(n=o/2),i<2*n&&(n=i/2),e.beginPath(),e.moveTo(a+n,r),e.arcTo(a+o,r,a+o,r+i,n),e.arcTo(a+o,r+i,a,r+i,n),e.arcTo(a,r+i,a,r,n),e.arcTo(a,r,a+o,r,n),e.clip(),e.closePath()}function k(e,t){u.default.showLoading("正在生成二维码");for(var n=[],a={text:t.text||"",size:t.size||200,background:t.background||"#ffffff",foreground:t.foreground||"#000000",pdground:t.pdground||"#000000",correctLevel:t.correctLevel||3,image:t.image||"",imageSize:t.imageSize||40,dx:t.dx||0,dy:t.dy||0},r=null,o=0,i=0,s=n.length;i<s;i++)if(o=i,n[i].text==a.text&&n[i].text.correctLevel==a.correctLevel){r=n[i].obj;break}o==s&&(r=new l.default(a.text,a.correctLevel),n.push({text:a.text,correctLevel:a.correctLevel,obj:r}));for(var c=function(e){var t=e.options;return t.pdground&&(e.row>1&&e.row<5&&e.col>1&&e.col<5||e.row>e.count-6&&e.row<e.count-2&&e.col>1&&e.col<5||e.row>1&&e.row<5&&e.col>e.count-6&&e.col<e.count-2)?t.pdground:t.foreground},f=r.getModuleCount(),h=a.size,d=a.imageSize,g=(h/f).toPrecision(4),p=(h/f).toPrecision(4),v=0;v<f;v++)for(var m=0;m<f;m++){var w=Math.ceil((m+1)*g)-Math.floor(m*g),y=Math.ceil((v+1)*g)-Math.floor(v*g),b=c({row:v,col:m,count:f,options:a});e.setFillStyle(r.modules[v][m]?b:a.background),e.fillRect(a.dx+Math.round(m*g),a.dy+Math.round(v*p),w,y)}if(a.image){var x=function(e,t,n,r,o,i,s,u,l){e.setLineWidth(s),e.setFillStyle(a.background),e.setStrokeStyle(a.background),e.beginPath(),e.moveTo(t+i,n),e.arcTo(t+r,n,t+r,n+i,i),e.arcTo(t+r,n+o,t+r-i,n+o,i),e.arcTo(t,n+o,t,n+o-i,i),e.arcTo(t,n,t+i,n,i),e.closePath(),u&&e.fill(),l&&e.stroke()},P=a.dx+Number(((h-d)/2).toFixed(2)),k=a.dy+Number(((h-d)/2).toFixed(2));x(e,P,k,d,d,2,6,!0,!0),e.drawImage(a.image,P,k,d,d)}u.default.hideLoading()}function T(e){e.backgroundImage,e.type;return new s.default(function(){var t=(0,i.default)(regeneratorRuntime.mark(function t(n,a){var i,s,l,c,f,h,d,g,p;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,u.default.showLoading("正在获取海报背景图"),i=!1,u.default.log("获取的缓存:"+(0,o.default)(i)),!(i&&i.path&&i.name)){t.next=52;break}return u.default.log("海报有缓存, 准备获取后端背景图进行对比"),t.next=8,u.default.getPosterUrl(e);case 8:if(s=t.sent,u.default.log("准备对比name是否相同"),i.name!==u.default.fileNameInPath(s)){t.next=44;break}return u.default.log("name相同, 判断该背景图是否存在于本地"),t.next=14,u.default.checkFile_PromiseFc(i.path);case 14:if(l=t.sent,!(l>=0)){t.next=36;break}return u.default.log("海报save路径存在, 对比宽高信息, 存储并输出"),t.next=19,u.default.getImageInfo_PromiseFc(i.path);case 19:if(c=t.sent,f=(0,r.default)({},i),i.width&&i.height&&i.width===c.width&&i.height===c.height){t.next=30;break}return u.default.log("宽高对比不通过， 重新获取"),t.next=25,C(e,s);case 25:h=t.sent,u.default.hideLoading(),n(h),t.next=34;break;case 30:u.default.log("宽高对比通过, 再次存储, 并返回路径"),f=(0,r.default)({},i,{width:c.width,height:c.height}),u.default.hideLoading(),n(f);case 34:t.next=42;break;case 36:return u.default.log("海报save路径不存在, 重新获取海报"),t.next=39,C(e,s);case 39:d=t.sent,u.default.hideLoading(),n(d);case 42:t.next=50;break;case 44:return u.default.log("name不相同, 重新获取海报"),t.next=47,C(e,s);case 47:g=t.sent,u.default.hideLoading(),n(g);case 50:t.next=58;break;case 52:return u.default.log("海报背景图没有缓存, 准备获取海报背景图"),t.next=55,C(e);case 55:p=t.sent,u.default.hideLoading(),n(p);case 58:t.next=66;break;case 60:t.prev=60,t.t0=t["catch"](0),u.default.hideLoading(),u.default.showToast("获取分享用户背景图失败:"+(0,o.default)(t.t0)),u.default.log((0,o.default)(t.t0)),a(t.t0);case 66:case"end":return t.stop()}},t,this,[[0,60]])}));return function(e,n){return t.apply(this,arguments)}}())}function L(e){var t=S(e),n=u.default.getStorageSync(t);n&&n.path&&(u.default.removeSavedFile(n.path),u.default.removeStorageSync(t))}function S(e){return c+(e||"default")}function C(e,t){e.backgroundImage;var n=e.type;return u.default.log("获取分享背景图, 尝试清空本地数据"),L(n),new s.default(function(){var n=(0,i.default)(regeneratorRuntime.mark(function n(a,i){var s,l,c,f,h,d,g,p;return regeneratorRuntime.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,u.default.showLoading("正在下载海报背景图"),!t){n.next=23;break}return u.default.log("有从后端获取的背景图片路径"),u.default.log("尝试下载并保存背景图"),s=u.default.fileNameInPath(t),n.next=8,u.default.downLoadAndSaveFile_PromiseFc(t);case 8:if(l=n.sent,!l){n.next=19;break}return u.default.log("下载并保存背景图成功:"+l),n.next=13,u.default.getImageInfo_PromiseFc(l);case 13:c=n.sent,f={path:l,width:c.width,height:c.height,name:s},u.default.hideLoading(),a(f),n.next=21;break;case 19:u.default.hideLoading(),i("not find savedFilePath");case 21:n.next=46;break;case 23:return u.default.log("没有从后端获取的背景图片路径, 尝试从后端获取背景图片路径"),n.next=26,u.default.getPosterUrl(e);case 26:return h=n.sent,u.default.log("尝试下载并保存背景图:"+h),n.next=30,u.default.downLoadAndSaveFile_PromiseFc(h);case 30:if(d=n.sent,!d){n.next=44;break}return u.default.log("下载并保存背景图成功:"+d),n.next=35,u.default.getImageInfo_PromiseFc(d);case 35:g=n.sent,u.default.log("获取图片信息成功"),p={path:d,width:g.width,height:g.height,name:u.default.fileNameInPath(h)},u.default.log("拼接背景图信息对象成功:"+(0,o.default)(p)),u.default.hideLoading(),u.default.log("返回背景图信息对象"),a((0,r.default)({},p)),n.next=46;break;case 44:u.default.hideLoading(),i("not find savedFilePath");case 46:n.next=51;break;case 48:n.prev=48,n.t0=n["catch"](0),i(n.t0);case 51:case"end":return n.stop()}},n,this,[[0,48]])}));return function(e,t){return n.apply(this,arguments)}}())}},b120:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */uni-page-body[data-v-5de76439]{width:100%;height:100%}.bg[data-v-5de76439]{width:100%;height:100%;background:url(http://wxapp.tegou100.com/static/images/erweimabg.png) no-repeat 50%;background-size:cover}.bg .shuoming[data-v-5de76439]{width:%?580?%;margin:0 %?85?%;text-align:center;color:#fff;font-size:%?30?%;padding-top:%?60?%;line-height:%?50?%}.bg .erweimabg[data-v-5de76439]{width:%?560?%;height:%?660?%;background:#fff;border-radius:%?30?%;margin:%?60?% %?95?%;text-align:center}.bg .erweimabg .nickname[data-v-5de76439]{width:%?560?%;color:#333;font-size:%?28?%;text-align:center;padding-top:%?70?%}.bg .erweimabg .smsm[data-v-5de76439]{width:%?560?%;color:#333;font-size:%?28?%;text-align:center;padding-top:%?23?%}.bg .erweimabg .ewm[data-v-5de76439]{width:%?350?%;height:%?350?%;margin-top:%?63?%}.bg .save[data-v-5de76439]{width:%?670?%;height:%?80?%;border:%?1?% solid #fff;margin:0 %?40?%;border-radius:%?10?%;line-height:%?80?%;text-align:center;color:#fff;font-size:%?28?%}',""])},b585:function(e,t,n){var a=n("e73d");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("4f06").default;r("943660f0",a,!0,{sourceMap:!1,shadowMode:!1})},b92f:function(e,t,n){var a=n("b120");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var r=n("4f06").default;r("038cb109",a,!0,{sourceMap:!1,shadowMode:!1})},ba4c:function(e,t,n){"use strict";n.r(t);var a=n("4a9c"),r=n.n(a);for(var o in a)"default"!==o&&function(e){n.d(t,e,function(){return a[e]})}(o);t["default"]=r.a},c1f5:function(e,t,n){"use strict";n.r(t);var a=n("64b2"),r=n("ba4c");for(var o in r)"default"!==o&&function(e){n.d(t,e,function(){return r[e]})}(o);n("830f");var i=n("2877"),s=Object(i["a"])(r["default"],a["a"],a["b"],!1,null,"5a6e37ea",null);t["default"]=s.exports},c4a3:function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("v-uni-view",{staticClass:"bg"},[n("v-uni-view",{staticClass:"shuoming"},[e._v("此二维码为您的身份凭证，可作为分享他人注册和身份验证使用")]),n("v-uni-view",{staticClass:"erweimabg"},[n("v-uni-view",{staticClass:"nickname"},[e._v(e._s(e.memberInfo.nickname?e.memberInfo.nickname:e.memberInfo.mobile))]),n("v-uni-view",{staticClass:"smsm"},[e._v("请扫描我的二维码进行注册")]),n("v-uni-image",{staticClass:"ewm",attrs:{src:e.memberInfo.qrcode,mode:""}})],1),n("v-uni-view",{staticClass:"save",on:{click:function(t){t=e.$handleEvent(t),e.save(t)}}},[e._v("保存到手机")])],1)},r=[];n.d(t,"a",function(){return a}),n.d(t,"b",function(){return r})},dbc6:function(e,t,n){"use strict";var a=n("b92f"),r=n.n(a);r.a},e73d:function(e,t,n){t=e.exports=n("2350")(!1),t.push([e.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */.content[data-v-5a6e37ea]{text-align:center;height:100%}.canvas_box .canvas_box_mask[data-v-5a6e37ea]{width:100%;height:100%;position:fixed;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.5);z-index:9}.canvas_box .canvas[data-v-5a6e37ea]{position:fixed!important;top:0!important;left:0!important;display:block!important;width:100%!important;height:100%!important;z-index:9}.canvas_box .button-wrapper[data-v-5a6e37ea]{width:%?320?%;height:%?72?%;position:absolute;bottom:%?20?%;left:%?215?%;z-index:16}.canvas_box .save_btn[data-v-5a6e37ea]{font-size:%?30?%;line-height:%?72?%;color:#fff;width:100%;height:100%;text-align:center;border-radius:%?45?%;border-radius:%?36?%;z-index:10}.canvas_box .canvas_close_btn[data-v-5a6e37ea]{position:fixed;top:%?30?%;right:0;z-index:12}',""])},fd68:function(e,t,n){"use strict";var a=n("288e");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;a(n("00e4")),a(n("a7ca"));var r=a(n("c1f5")),o=(n("2f62"),{components:{hchPoster:r.default},data:function(){return{token:"",memberInfo:[],poster:{},qrShow:!1,canvasId:"default_PosterCanvasId"}},onLoad:function(){if(uni.getStorageSync("cbe_token"))this.token=uni.getStorageSync("cbe_token"),this.getMemberInfo();else{uni.showToast({title:"未登录或无权限",icon:"none"});setTimeout(function(){uni.navigateBack({delta:1})},1e3)}},methods:{save:function(){},getMemberInfo:function(){var e=this;uni.showLoading({title:"加载中",mask:!0}),uni.request({url:uni.getStorageSync("hostname")+"?action=index/member/info",data:{token:uni.getStorageSync("cbe_token")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){uni.hideLoading();var n=t.data;0==n.code&&(e.memberInfo=n.one)}})}}});t.default=o}}]);