(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-public-phonelogin"],{6735:function(t,e,i){"use strict";i.r(e);var n=i("cfed"),o=i("9f93");for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);i("b524");var s=i("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,"22e6f4f0",null);e["default"]=c.exports},"6c7b":function(t,e,i){var n=i("5ca1");n(n.P,"Array",{fill:i("36bd")}),i("9c6c")("fill")},9977:function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("6c7b");var o=n(i("e814")),a=n(i("cebc")),s=i("2f62"),c={data:function(){return{mobile:"",imgcode:"",imgyzcode:"",phonecode:"",phonetoken:"",logining:!1,scode:!1,getcode:"获取验证码",width:70,height:30}},onLoad:function(){var t=this;setTimeout(function(){t.init()},100),console.log(uni.getStorageSync("cbe_retoken"))},methods:(0,a.default)({},(0,s.mapMutations)(["register","login"]),{inputChange:function(t){var e=t.currentTarget.dataset.key;this[e]=t.detail.value},toPhone:function(){uni.redirectTo({url:"dsflogin"})},toRegister:function(){uni.redirectTo({url:"zhecexieyi"})},toLogin:function(){var t=this;this.logining=!0;var e=/^1[0-9]{10,10}$/;return this.mobile?e.test(this.mobile)?this.imgcode?this.imgcode!=this.imgyzcode?(uni.showToast({title:"图形验证码错误",icon:"none"}),this.logining=!1,!1):this.phonecode?(uni.showLoading({title:"正在登录",mask:!0}),void uni.request({url:uni.getStorageSync("hostname")+"?action=index/login/phonelogin",data:{phone:this.mobile,imgcode:this.imgcode,code:this.phonecode,token:this.phonetoken,usertoken:uni.getStorageSync("cbe_retoken")},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(e){uni.hideLoading();var i=e.data;if(0==i.code){uni.setStorageSync("cbe_token",i.token),t.phonetoken="",uni.showToast({title:i.msg,icon:"success",mask:!0,duration:3e3}),t.login(i.data);setTimeout(function(){uni.navigateBack({delta:1})},3e3)}else uni.showToast({title:i.msg,icon:"none"}),t.logining=!1}})):(uni.showToast({title:"手机验证码不能为空",icon:"none"}),this.logining=!1,!1):(uni.showToast({title:"图形验证码不能为空",icon:"none"}),this.logining=!1,!1):(uni.showToast({title:"手机号码格式错误",icon:"none"}),this.logining=!1,!1):(uni.showToast({title:"手机号码不能为空",icon:"none"}),this.logining=!1,!1)},getPhoneCode:function(t){var e=this;if(0==this.scode){var i=/^1[0-9]{10,10}$/;if(i.test(this.mobile)){if(!this.imgcode)return uni.showToast({title:"图形验证码不能为空",icon:"none"}),!1;if(this.imgcode!=this.imgyzcode)return uni.showToast({title:"图形验证码错误",icon:"none"}),this.logining=!1,!1;var n=120;this.scode=!0,this.timer=setInterval(function(){n-=1,"0"==n?(e.getcode="获取验证码",n=120,e.scode=!1,clearInterval(e.timer)):e.getcode="重新获取("+n+"s)"},1e3),uni.showLoading({title:"正在获取",mask:!0}),uni.request({url:uni.getStorageSync("hostname")+"?action=index/common/getphonecode",data:{phone:this.mobile,use:"login"},method:"POST",dataType:"json",header:{"content-type":"application/x-www-form-urlencoded"},success:function(t){uni.hideLoading();var i=t.data;0==i.code?(uni.showToast({title:i.msg,icon:"success",mask:!0,duration:3e3}),e.phonetoken=i.token):(uni.showToast({title:i.msg,icon:"none"}),e.getcode="获取验证码",n=120,e.scode=!1,clearInterval(e.timer))},fail:function(t){uni.showToast({title:"网络连接超时，请检查您的网络",icon:"none"});setTimeout(function(){e.getcode="获取验证码",n=120,e.scode=!1,clearInterval(e.timer)},1e3)}})}else uni.showToast({title:"手机号码格式错误",icon:"none"})}},init:function(){var t=uni.createCanvasContext("imgcanvas",this),e=this.width,i=this.height;t.setFillStyle("white"),t.setLineWidth(5),t.fillRect(0,0,e,i);for(var n=["A","B","C","D","E","F","G","H","J","K","L","M","N","P","Q","R","S","T","U","V","W","S","Y","Z","1","2","3","4","5","6","7","8","9","0"],a="",s=0;s<4;s++){var c=n[this.rn(0,n.length)],r=this.rn(-30,30);t.setFontSize(18),t.setTextBaseline("top"),t.setFillStyle(this.rc(80,150)),t.save(),t.translate(15*s+15,(0,o.default)(i/1.5)),t.rotate(r*Math.PI/180),t.fillText(c,-10,-15),t.restore(),a+=c}uni.setStorage({key:"imgcode",data:a}),this.imgyzcode=a;for(s=0;s<40;s++)t.beginPath(),t.arc(this.rn(0,e),this.rn(0,i),1,0,2*Math.PI),t.closePath(),t.setFillStyle(this.rc(150,200)),t.fill();t.draw()},rc:function(t,e){var i=this.rn(t,e),n=this.rn(t,e),o=this.rn(t,e);return"rgb("+i+","+n+","+o+")"},rn:function(t,e){return(0,o.default)(Math.random()*(t-e))+e},refresh:function(){this.init()},canvasIdErrorCallback:function(t){console.error(t.detail.errMsg)}})};e.default=c},"9f93":function(t,e,i){"use strict";i.r(e);var n=i("9977"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=o.a},b524:function(t,e,i){"use strict";var n=i("d2fc"),o=i.n(n);o.a},cfed:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"container"},[i("v-uni-view",{staticClass:"input-content"},[i("v-uni-view",{staticClass:"input-item"},[i("v-uni-input",{attrs:{type:"text",value:t.mobile,placeholder:"请输入手机号码","placeholder-style":"color:#cbcbcb",maxlength:"11","data-key":"mobile"},on:{input:function(e){e=t.$handleEvent(e),t.inputChange(e)}}})],1),i("v-uni-view",{staticClass:"input-item"},[i("v-uni-input",{attrs:{type:"text",value:t.imgcode,placeholder:"请输入图形验证码","placeholder-style":"color:#cbcbcb","placeholder-class":"input-empty",maxlength:"4","data-key":"imgcode"},on:{input:function(e){e=t.$handleEvent(e),t.inputChange(e)}}}),i("v-uni-view",{staticClass:"canvas-img-code",on:{click:function(e){e=t.$handleEvent(e),t.refresh(e)}}},[i("v-uni-canvas",{style:{width:t.width+"px",height:t.height+"px"},attrs:{"canvas-id":"imgcanvas"},on:{error:function(e){e=t.$handleEvent(e),t.canvasIdErrorCallback(e)}}})],1),i("v-uni-view",{staticClass:"kabuqing",on:{click:function(e){e=t.$handleEvent(e),t.refresh(e)}}},[t._v("换一张")])],1),i("v-uni-view",{staticClass:"input-item"},[i("v-uni-input",{attrs:{type:"number",value:t.phonecode,placeholder:"请输入手机验证码","placeholder-style":"color:#cbcbcb","placeholder-class":"input-empty",maxlength:"6","data-key":"phonecode"},on:{input:function(e){e=t.$handleEvent(e),t.inputChange(e)},confirm:function(e){e=t.$handleEvent(e),t.toLogin(e)}}}),i("v-uni-text",{on:{click:function(e){e=t.$handleEvent(e),t.getPhoneCode(e)}}},[t._v(t._s(t.getcode))])],1),i("v-uni-view",{staticClass:"forget-section"},[i("v-uni-text",{on:{click:function(e){e=t.$handleEvent(e),t.toPhone(e)}}},[t._v("账号密码登录")]),i("v-uni-text",{on:{click:function(e){e=t.$handleEvent(e),t.toRegister(e)}}},[t._v("注册")])],1),i("v-uni-view",{staticStyle:{clear:"both",height:"100upx"}}),i("v-uni-button",{staticClass:"confirm-btn",attrs:{disabled:t.logining},on:{click:function(e){e=t.$handleEvent(e),t.toLogin(e)}}},[t._v("登录")])],1)],1)},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})},d2fc:function(t,e,i){var n=i("e7cb");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var o=i("4f06").default;o("0ea22318",n,!0,{sourceMap:!1,shadowMode:!1})},e7cb:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'@charset "UTF-8";\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */uni-page-body[data-v-22e6f4f0]{background:#fff}.tishi[data-v-22e6f4f0]{width:%?690?%;font-size:%?24?%;color:#343434;line-height:%?100?%}.container[data-v-22e6f4f0]{position:relative;width:100vw;height:100vh;overflow:hidden;background:#fff}.wrapper[data-v-22e6f4f0]{position:relative;z-index:90;background:#fff;padding-bottom:%?40?%}.input-content[data-v-22e6f4f0]{padding:%?40?% %?30?%}.input-item[data-v-22e6f4f0]{position:relative;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;-ms-flex-align:start;align-items:flex-start;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;height:%?100?%;border-radius:4px;margin-bottom:%?10?%;border-bottom:%?1?% solid #eaeaea}.input-item[data-v-22e6f4f0]:last-child{margin-bottom:0}.input-item .tit[data-v-22e6f4f0]{height:%?50?%;line-height:%?56?%;font-size:%?26?%;color:#606266}.input-item uni-input[data-v-22e6f4f0]{height:%?50?%;font-size:%?30?%;color:#303133;width:100%}.input-item uni-text[data-v-22e6f4f0]{position:absolute;right:%?0?%;font-size:%?30?%;color:#b2b2b2;border:%?1?% solid #b2b2b2;padding:%?8?% %?30?%;border-radius:%?50?%;z-index:999}.input-item .uu[data-v-22e6f4f0]{position:absolute;right:0;font-size:%?26?%;color:#08b000}.input-item .uuu[data-v-22e6f4f0]{position:absolute;right:0;font-size:%?26?%;color:#b0002f}.input-item .canvas-img-code[data-v-22e6f4f0]{position:absolute;right:%?120?%;z-index:999}.input-item .canvas-img-code uni-canvas[data-v-22e6f4f0]{border:%?1?% solid #eaeaea;background:#eaeaea}.input-item .uni-icon[data-v-22e6f4f0]{position:absolute;right:%?20?%;font-size:%?40?%;z-index:999;color:#008ab0}.input-item .uni-icon uni-image[data-v-22e6f4f0]{width:%?40?%;height:%?40?%}.input-item .kabuqing[data-v-22e6f4f0]{position:absolute;right:0;z-index:999;color:#008ab0;font-size:%?30?%}.confirm-btn[data-v-22e6f4f0]{width:%?690?%;height:%?76?%;line-height:%?76?%;border-radius:50px;margin-top:%?30?%;background:#008ab0;color:#fff;font-size:%?32?%}.confirm-btn[data-v-22e6f4f0]:after{border-radius:100px}.forget-section[data-v-22e6f4f0]{font-size:%?30?%;color:#008ab0;text-align:center;margin-top:%?40?%}.forget-section[data-v-22e6f4f0] :first-child{float:left;padding-left:%?30?%}.forget-section[data-v-22e6f4f0] :last-child{float:right;padding-right:%?30?%}body.?%PAGE?%[data-v-22e6f4f0]{background:#fff}',""])}}]);